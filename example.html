
<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Example JavaScript RESTful URL generator Amazon's Mechanical Turk Requester API" />
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Example JavaScript RESTful URL generator Amazon's Mechanical Turk Requester API</title>
    
    <script src="hmac-sha1.js"></script>  
    <script src="enc-base64-min.js"></script>
    <script src="amt-js-operations.js"></script>
    <style type="text/css">
      #signature, #timestamp, #ecsignature, #ectimestamp {
        width: 60%;
      }
      /*Overwrite width of main content. Default=640px.*/
      #main_content {
       max-width: 800px !important;
      }
      .span_float {
        float:left;
        width:200px;
      }
    </style>
    
    <script type="text/javascript">
    window.onload = function() {
      var A = new amt();
      // Populate select field
      // This is retrieved from `http://docs.aws.amazon.com/AWSMechTurk/latest/AWSMturkAPI/ApiReference_OperationsArticle.html`.
      // Retrieval date: June 19, 2015.
      var select = document.getElementById('operations');
      for (var i in A.opts) {
        var opt = document.createElement('option');
        opt.innerText = A.opts[i];
        opt.value = A.opts[i];
        select.appendChild(opt);
      }
      function generate_key() {
        var key = document.getElementById('key');
        var select = document.getElementById('operations');
        var showsg = document.getElementById('signature');
        var showts = document.getElementById('timestamp');
        var ecshowsg = document.getElementById('ecsignature');
        var ecshowts = document.getElementById('ectimestamp');
        var stub_url = document.getElementById('stub_url');
        
        var result = A.generate_key({
          operation: select.value,
          secret_key: key.value
        });
        
        showsg.value = result.signature;
        showts.value = result.timestamp;
        ecshowsg.value = result.url_encoded_signature;
        ecshowts.value = result.url_encoded_timestamp;
        stub_url.value = result.stub_url;
      }
    }
    </script>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/their/amt-js-operations">View on GitHub</a>

          <h1 id="project_title">AMT AWS Requester Services URL Generator</h1>
          

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/their/amt-js-operations/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/their/amt-js-operations/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        
        <h3>AMT AWS Requester Services URL Generator.</h3>
        
        <p>
        For Requesters on the website mturk.com, Amazon.com's Mechanical Turk workplace.
        In order to make a web request "REST"to the Amazon mturk.com API it is necessary to provide a "signature".
        According to the AWS documentation this signature is generated in the following manner:
        
        <code>
A request signature, an HMAC, is calculated by concatenating the values of the Service, Operation, and Timestamp parameters, in that order, and then calculating an RFC 2104-compliant HMAC, using the Secret Access Key as the "key." 
        </code> (<a href="http://docs.aws.amazon.com/AWSMechTurk/latest/AWSMechanicalTurkRequester/MakingRequests_RequestAuthenticationArticle.html">link</a>).
        
    		Generally speaking the signature is the only dynamic portion of most AMT AWS Requester Services requests.
    		Although in the documentation there are only examples of calculating the signature in Java, Python, etc., it is of course possible to calculate it using JavaScript.
    		
    		The following two libraries provide the functionality to create the AWS signature:
    		
    		<code><pre>
http://crypto-js.googlecode.com/svn/tags/3.0.2/build/rollups/hmac-sha1.js
http://crypto-js.googlecode.com/svn/tags/3.0.2/build/components/enc-base64-min.js
    		</pre></code>
    		
    		For example, by including the following two libraries...</p>
    		
        <pre><code style="zoom:1;">
function generate_key() {
  var key = document.getElementById('key');
  var select = document.getElementById('operations');
  var showsg = document.getElementById('signature');
  var showts = document.getElementById('timestamp');
  var ecshowsg = document.getElementById('ecsignature');
  var ecshowts = document.getElementById('ectimestamp');
  var stub_url = document.getElementById('stub_url');
  
  var result = A.generate_key({
    operation: select.value,
    secret_key: key.value
  });
  
  showsg.value = result.signature;
  showts.value = result.timestamp;
  ecshowsg.value = result.url_encoded_signature;
  ecshowts.value = result.url_encoded_timestamp;
  stub_url.value = result.stub_url;
}
        </code></pre>
        
        <p>
        AMT AWS Requester Services URL Generator.<br />
        <span class="span_float">Operation:</span><select id="operations"></select>
        (<a href="http://docs.aws.amazon.com/AWSMechTurk/latest/AWSMturkAPI/ApiReference_OperationsArticle.html">Operations API Reference</a>)<br />
        <span class="span_float">AWS Requester Secret Key:</span><input type="text" id="key" placeholder="YOURSECRETKEY" /><br />
        <input type="button" value="Generate Signature!" onclick="generate_key();" style="zoom:2;" /><br />
        <h4>Results:</h4>
        <span class="span_float">Signature:</span><input type="text" id="signature" disabled /><br />
        <span class="span_float">Timestamp:</span><input type="text" id="timestamp" disabled /><br />
        <h4>Results in URL Encoded Format:</h4>
        <span class="span_float">Signature:</span><input type="text" id="ecsignature" disabled /><br />
        <span class="span_float">Timestamp:</span><input type="text" id="ectimestamp" disabled /><br />
        <h4>Initial URL:</h4>
        <input type="text" id="stub_url" disabled /><br />
        <br />
        For example, to assign a qualification to a worker:</p>
        
        <pre><code style="zoom:1;">
https://mechanicalturk.amazonaws.com/?Service=AWSMechanicalTurkRequester
&AWSAccessKeyId=[AWS_REQUESTER_ACCESS_KEY, e.g. 123RVWYBAZW00EXAMPLE]
&Version=2014-08-15
&Operation=AssignQualification
&Signature=[SIGNATURE FROM ABOVE IN ENCODED URL FORMAT]
&Timestamp=[TIMESTAMP FROM ABOVE IN ENCODED URL FORMAT]
&QualificationTypeId=[QUALIFICATIONID, e.g. 789RVWYBAZW00EXAMPLE]
&WorkerId=[WORKERID, e.g. AZ3456EXAMPLE]
&IntegerValue=[QUALIFICATION_VALUE, e.g. 90]
&SendNotification=[true|false, Default If Blank=true]
        </code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Tools for Amazon's Mechanical Turk maintained by David Shumway and FLBS: <a href="https://github.com/their">their</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
